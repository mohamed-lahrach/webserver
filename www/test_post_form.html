<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CGI POST Test Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-family: monospace;
            font-size: 14px;
            resize: vertical;
            box-sizing: border-box;
        }
        textarea:focus {
            border-color: #4CAF50;
            outline: none;
        }
        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover {
            background: #45a049;
        }
        .test-btn {
            background: #2196F3;
        }
        .test-btn:hover {
            background: #1976D2;
        }
        .clear-btn {
            background: #f44336;
        }
        .clear-btn:hover {
            background: #d32f2f;
        }
        .examples {
            margin-top: 30px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 5px;
            border-left: 4px solid #4CAF50;
        }
        .examples h3 {
            margin-top: 0;
            color: #333;
        }
        .example-item {
            margin-bottom: 10px;
            padding: 8px;
            background: white;
            border-radius: 3px;
            cursor: pointer;
            border: 1px solid #ddd;
        }
        .example-item:hover {
            background: #e8f5e8;
        }
        select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            background: white;
            box-sizing: border-box;
        }
        select:focus {
            border-color: #4CAF50;
            outline: none;
        }
        input[type="file"] {
            width: 100%;
            padding: 10px;
            border: 2px dashed #ddd;
            border-radius: 5px;
            background: #fafafa;
            cursor: pointer;
            box-sizing: border-box;
        }
        input[type="file"]:hover {
            border-color: #4CAF50;
            background: #f0f8f0;
        }
        .info {
            margin-top: 20px;
            padding: 15px;
            background: #e3f2fd;
            border-radius: 5px;
            border-left: 4px solid #2196F3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ CGI POST Data Tester</h1>
        
        <form id="postForm" action="/cgi-bin/test_file_read.py" method="POST" target="_blank">
            <div class="form-group">
                <label for="cgiScript">Choose CGI script:</label>
                <select id="cgiScript">
                    <option value="/cgi-bin/test_file_read.py">Basic Test Script</option>
                    <option value="/cgi-bin/enhanced_test.py">Enhanced Analysis Script</option>
                    <option value="/cgi-bin/file_handler.py">File Handler (Save with Original Name)</option>
                </select>
            </div>

            <div class="form-group">
                <label for="dataType">Choose data type:</label>
                <select id="dataType" onchange="toggleInputType()">
                    <option value="text">Text Data</option>
                    <option value="file">File Upload (Image/Video)</option>
                </select>
            </div>

            <div class="form-group" id="textInput">
                <label for="postData">Enter your raw POST data:</label>
                <textarea 
                    id="postData" 
                    name="rawdata" 
                    rows="6" 
                    placeholder="Type any raw data here... No form field names needed!&#10;&#10;Examples:&#10;- Hello World&#10;- JSON data: {&quot;name&quot;: &quot;test&quot;}&#10;- Plain text message&#10;- Any custom format you want"
                ></textarea>
            </div>

            <div class="form-group" id="fileInput" style="display: none;">
                <label for="fileUpload">Select Image or Video file:</label>
                <input type="file" id="fileUpload" accept="image/*,video/*" onchange="displayFileInfo()">
                <div id="fileInfo" style="margin-top: 10px; padding: 10px; background: #f9f9f9; border-radius: 5px; display: none;">
                    <p><strong>File Details:</strong></p>
                    <p id="fileName"></p>
                    <p id="fileSize"></p>
                    <p id="fileType"></p>
                </div>
            </div>
            
            <div class="button-group">
                <button type="submit">üì§ Send POST Request</button>
                <button type="button" class="test-btn" onclick="testGet()">üîç Test GET Request</button>
                <button type="button" class="clear-btn" onclick="clearForm()">üóëÔ∏è Clear</button>
            </div>
        </form>

        <div class="examples" id="textExamples">
            <h3>üìã Text Data Testing:</h3>
            <p>Enter any raw text data in the textarea above.</p>
        </div>

        <div class="examples" id="fileExamples" style="display: none;">
            <h3>üìÅ File Upload Testing:</h3>
            <p><strong>Supported formats:</strong></p>
            <ul>
                <li>üñºÔ∏è <strong>Images:</strong> .jpg, .jpeg, .png, .gif, .webp, .bmp, .svg</li>
                <li>üé• <strong>Videos:</strong> .mp4, .avi, .mov, .mkv, .webm, .flv</li>
            </ul>
            <p><strong>What happens:</strong> The file will be saved with its original name and extension.</p>
            <p><strong>File size limit:</strong> Depends on your server configuration.</p>
        </div>

        <div class="info">
            <strong>üí° How it works:</strong><br>
            ‚Ä¢ <strong>Text Mode:</strong> Your raw text data is sent directly to the CGI script<br>
            ‚Ä¢ <strong>File Mode:</strong> The entire file is saved with its original name and extension<br>
            ‚Ä¢ Your webserver saves the data to a file with the proper name<br>
            ‚Ä¢ The CGI script can read from both the file and stdin<br>
            ‚Ä¢ Perfect for testing file uploads with proper naming!
        </div>
    </div>

    <script>
        function clearForm() {
            document.getElementById('postData').value = '';
            document.getElementById('fileUpload').value = '';
            document.getElementById('fileInfo').style.display = 'none';
        }
        
        function testGet() {
            window.open('/cgi-bin/test_file_read.py', '_blank');
        }

        function toggleInputType() {
            const dataType = document.getElementById('dataType').value;
            const textInput = document.getElementById('textInput');
            const fileInput = document.getElementById('fileInput');
            const textExamples = document.getElementById('textExamples');
            const fileExamples = document.getElementById('fileExamples');
            
            if (dataType === 'text') {
                textInput.style.display = 'block';
                fileInput.style.display = 'none';
                textExamples.style.display = 'block';
                fileExamples.style.display = 'none';
            } else {
                textInput.style.display = 'none';
                fileInput.style.display = 'block';
                textExamples.style.display = 'none';
                fileExamples.style.display = 'block';
            }
        }

        function displayFileInfo() {
            const fileInput = document.getElementById('fileUpload');
            const fileInfo = document.getElementById('fileInfo');
            const fileName = document.getElementById('fileName');
            const fileSize = document.getElementById('fileSize');
            const fileType = document.getElementById('fileType');
            
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                fileName.textContent = 'Name: ' + file.name;
                fileSize.textContent = 'Size: ' + formatFileSize(file.size);
                fileType.textContent = 'Type: ' + file.type;
                fileInfo.style.display = 'block';
            } else {
                fileInfo.style.display = 'none';
            }
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Handle form submission to send raw data or file data
        document.getElementById('postForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const dataType = document.getElementById('dataType').value;
            const form = e.target;
            
            if (dataType === 'text') {
                // Send text data
                const rawData = document.getElementById('postData').value;
                const actionUrl = document.getElementById('cgiScript').value;
                
                fetch(actionUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain'
                    },
                    body: rawData
                })
                .then(response => response.text())
                .then(html => {
                    const newWindow = window.open('', '_blank');
                    newWindow.document.write(html);
                    newWindow.document.close();
                })
                .catch(error => {
                    alert('Error: ' + error);
                });
            } else {
                // Send file data
                const fileInput = document.getElementById('fileUpload');
                if (fileInput.files.length === 0) {
                    alert('Please select a file first!');
                    return;
                }
                
                const file = fileInput.files[0];
                const actionUrl = document.getElementById('cgiScript').value;
                
                fetch(actionUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/octet-stream',
                        'X-File-Name': file.name,
                        'X-File-Type': file.type,
                        'X-File-Size': file.size.toString()
                    },
                    body: file
                })
                .then(response => response.text())
                .then(html => {
                    const newWindow = window.open('', '_blank');
                    newWindow.document.write(html);
                    newWindow.document.close();
                })
                .catch(error => {
                    alert('Error: ' + error);
                });
            }
        });
    </script>
</body>
</html>
